<?xml version="1.0"?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Crossword Composer</title>
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
    <script>
      $(document).ready(function () {

        $("#mozart").click(create_menus);

        //  ===========================================================
        //  create_help_menu: Creates the "help" menu
        //  ===========================================================
        function create_help_menu() {
          $("#menubar").append(
            '<a class="w3-bar-item w3-button w3-right" href="https://github.com/philhanna/crossword/wiki">Help</a>'
          );
        }

        //  ===========================================================
        //  create_menu: Creates a menu on the menu bar
        //  ===========================================================
        function create_menu(name) {
          let elem = document.createElement("div");
          elem.setAttribute("class", "w3-dropdown-hover w3-blue-gray");

          let elemButton = document.createElement("button");
          elemButton.setAttribute("id", `btn + ${name}`);
          elemButton.setAttribute("class", "w3-button");
          elem.appendChild(elemButton)

          let text = document.createTextNode(`${name}`);
          elemButton.appendChild(text);

          let elemDrop = document.createElement("div");
          elemDrop.setAttribute("id", `drop + ${name}`);
          elemDrop.setAttribute("class", "w3-dropdown-content w3-bar-block w3-card-4");
          elem.appendChild(elemDrop)

          return [elem, elemDrop];
        }

        function create_menu_item(mnuItem) {
          var classNames = "w3-bar-item w3-button";
          
          let elem = document.createElement("div");
          
          let elemA = document.createElement("a");
          elemA.setAttribute("id", mnuItem.id)
          elemA.setAttribute("class", classNames);
          elem.appendChild(elemA)

          let text = document.createTextNode(mnuItem.label)
          elemA.appendChild(text)

          return elem
        }
        
        function create_menus() {
          $.getJSON("menu.json", function(data) {
            let root = data["menudata"];
            for (var i = 0; i < root.length; i++) {
              let mnu = root[i];
              let elemMnuTuple = create_menu(mnu.name);
              let elemMnu = elemMnuTuple[0]
              let elemDrop = elemMnuTuple[1]
              $("#menubar").append(elemMnu)

              for (var j = 0; j < mnu.items.length; j++) {
                let mnuItem = mnu.items[j];
                let elemMnuItem = create_menu_item(mnuItem);
                elemDrop.appendChild(elemMnuItem);
              }
            }
          });
          create_help_menu();
        }
 
      });
    </script>
  </head>
  <body>
    <div class="w3-container w3-padding">
      <h1>
        <img
          id="mozart"
          alt="Mozart looking at crossword puzzle"
          src="https://github.com/philhanna/cwcomp/assets/3708685/ae96d3ed-36c0-47e1-b948-f3614058385e"
          width="80px"
        />
        <span class="w3-padding">Crossword Composer</span>
      </h1>
      <div id="menubar" class="w3-bar w3-blue-gray mb"></div>
    </div>
  </body>
</html>
